---
title: "Project"
author: "Santosh Reddy Edulapalle"
date: "2022-11-07"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

We will use this markdown file to code our project and write any relevant updates.
```{r}
print("Hello World!")
```

Data set:
 
This dataset consists of several samller datasets. Now we will try to combine all those smaller datasets to make main big dataframe to make things easier.

Since there are many columns in dataset, we like to reduce some redundant columns by talking average of months by general agricultural seasons in India.
Kharif - July - October.
Rabi - November - April
Zaid - March - June

But now for analysis reasons, we consider Rabi to be only November to February.

```{r}
df.rice.farm.harvest.price <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Rice_farm_harvest_price.csv")


df.rice.area.production.yield <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Rice_area_production_yield.csv")


df.irrigation.sourcewise.irrigated.area <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Irrigation_sourcewise_irrigated_area.csv")


df.irrigation.rice.area <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Irrigation_rice_area.csv")


df.inputs.wages <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Inputs_wages.csv")


df.inputs.season.fertilizer.consumption <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Inputs_season_fertilizer_consumption.csv")


df.inputs.fertilizer.consumption <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Inputs_fertilizer_consumption.csv")

df.environment.temperature.minimum <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Environment_temperature_minimum*.csv")

df.environment.temperature.maximum <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Environment_temperature_maximum*.csv")

df.environment.precipitation <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Environment_precipitation*.csv")

df.environment.evapotranspiration.potential <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Environment_evapotranspiration_potential*.csv")

df.environment.evapotranspiration.actual <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Environment_evapotranspiration_actual*.csv")

df.biophysical.soil.type1 <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Biophysical_soil_type1.csv")

df.biophysical.monthly.rainfall <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Biophysical_monthly_rainfall.csv")

df.biophysical.length.of.growing.period <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Biophysical_length_of_growing_period.csv")

df.biophysical.landuse <- read.csv("/Users/santosh/Documents/CSP571/CSP571-DPA/Datasets/Biophysical_landuse.csv")


```

```{r}
#calculating means 
#df.biophysical.monthly.rainfall
df.biophysical.monthly.rainfall$Zaid.rainfall.mm <- rowMeans(df.biophysical.monthly.rainfall[,c("MARCH.RAINFALL..Millimeters.","APRIL.RAINFALL..Millimeters.","MAY.RAINFALL..Millimeters.","JUNE.RAINFALL..Millimeters.")])
df.biophysical.monthly.rainfall$Kharif.rainfall.mm <- rowMeans(df.biophysical.monthly.rainfall[,c("JULY.RAINFALL..Millimeters.","AUGUST.RAINFALL..Millimeters.","SEPTEMBER.RAINFALL..Millimeters.","OCTOBER.RAINFALL..Millimeters.")])
df.biophysical.monthly.rainfall$Rabi.rainfall.mm <- rowMeans(df.biophysical.monthly.rainfall[,c("NOVEMBER.RAINFALL..Millimeters.","DECEMBER.RAINFALL..Millimeters.","JANUARY.RAINFALL..Millimeters.","FEBRUARY.RAINFALL..Millimeters.")])

#df.environment.evapotranspiration.actual
df.environment.evapotranspiration.actual$Zaid.evapotranspiration.actual.mm<-
  rowMeans(df.environment.evapotranspiration.actual[,c("MARCH.ACTUAL..Millimeters.","APRIL.ACTUAL..Millimeters.","MAY.ACTUAL..Millimeters.","JUNE.ACTUAL..Millimeters.")])
df.environment.evapotranspiration.actual$Kharif.evapotranspiration.actual.mm<-
  rowMeans(df.environment.evapotranspiration.actual[,c("JULY.ACTUAL..Millimeters.","AUGUST.ACTUAL..Millimeters.","SEPTEMBER.ACTUAL..Millimeters.","OCTOBER.ACTUAL..Millimeters.")])
df.environment.evapotranspiration.actual$Rabi.evapotranspiration.actual.mm<-
  rowMeans(df.environment.evapotranspiration.actual[,c("NOVEMBER.ACTUAL..Millimeters.","DECEMBER.ACTUAL..Millimeters.","JANUARY.ACTUAL..Millimeters.","FEBRUARY.ACTUAL..Millimeters.")])


#df.environment.evapotranspiration.potential
df.environment.evapotranspiration.potential$Zaid.evapotranspiration.potential.mm<-
  rowMeans(df.environment.evapotranspiration.potential[,c("MARCH.POTENTIAL..Millimeters.","APRIL.POTENTIAL..Millimeters.","MAY.POTENTIAL..Millimeters.","JUNE.POTENTIAL..Millimeters.")])
df.environment.evapotranspiration.potential$Kharif.evapotranspiration.potential.mm<-
  rowMeans(df.environment.evapotranspiration.potential[,c("JULY.POTENTIAL..Millimeters.","AUGUST.POTENTIAL..Millimeters.","SEPTEMBER.POTENTIAL..Millimeters.","OCTOBER.POTENTIAL..Millimeters.")])
df.environment.evapotranspiration.potential$Rabi.evapotranspiration.potential.mm<-
  rowMeans(df.environment.evapotranspiration.potential[,c("NOVEMBER.POTENTIAL..Millimeters.","DECEMBER.POTENTIAL..Millimeters.","JANUARY.POTENTIAL..Millimeters.","FEBRUARY.POTENTIAL..Millimeters.")])

#df.environment.precipitation
df.environment.precipitation$Zaid.percipitation.mm <- rowMeans( df.environment.precipitation[,c("MARCH.PERCIPITATION..Millimeters.","APRIL.PERCIPITATION..Millimeters.","MAY.PERCIPITATION..Millimeters.","JUNE.PERCIPITATION..Millimeters.")])
df.environment.precipitation$Kharif.percipitation.mm <- rowMeans( df.environment.precipitation[,c("JULY.PERCIPITATION..Millimeters.","AUGUST.PERCIPITATION..Millimeters.","SEPTEMBER.PERCIPITATION..Millimeters.","OCTOBER.PERCIPITATION..Millimeters.")])
df.environment.precipitation$Rabi.percipitation.mm <-rowMeans( df.environment.precipitation[,c("NOVEMBER.PERCIPITATION..Millimeters.","DECEMBER.PERCIPITATION..Millimeters.","JANUARY.PERCIPITATION..Millimeters.","FEBRUARY.PERCIPITATION..Millimeters.")])


#df.environment.temperature.maximum

df.environment.temperature.maximum$Zaid.temp.max.c <- rowMeans(df.environment.temperature.maximum[,c("MARCH.MAXIMUM..Centigrate.","APRIL.MAXIMUM..Centigrate.","MAY.MAXIMUM..Centigrate.","JUNE.MAXIMUM..Centigrate.")])
df.environment.temperature.maximum$Kharif.temp.max.c <- rowMeans(df.environment.temperature.maximum[,c("JULY.MAXIMUM..Centigrate.","AUGUST.MAXIMUM..Centigrate.","SEPTEMBER.MAXIMUM..Centigrate.","OCTOBER.MAXIMUM..Centigrate.")])
df.environment.temperature.maximum$Rabi.temp.max.c <- rowMeans(df.environment.temperature.maximum[,c("NOVEMBER.MAXIMUM..Centigrate.","DECEMBER.MAXIMUM..Centigrate.","JANUARY.MAXIMUM..Centigrate.","FEBRUARY.MAXIMUM..Centigrate.")])

#df.environment.temperature.minimum

df.environment.temperature.minimum$Zaid.temp.min.c <- rowMeans(df.environment.temperature.minimum[,c("MARCH.MINIMUM..Centigrate.","APRIL.MINIMUM..Centigrate.","MAY.MINIMUM..Centigrate.","JUNE.MINIMUM..Centigrate.")])
df.environment.temperature.minimum$Kharif.temp.min.c <- rowMeans(df.environment.temperature.minimum[,c("JULY.MINIMUM..Centigrate.","AUGUST.MINIMUM..Centigrate.","SEPTEMBER.MINIMUM..Centigrate.","OCTOBER.MINIMUM..Centigrate.")])
df.environment.temperature.minimum$Rabi.temp.min.c <- rowMeans(df.environment.temperature.minimum[,c("NOVEMBER.MINIMUM..Centigrate.","DECEMBER.MINIMUM..Centigrate.","JANUARY.MINIMUM..Centigrate.","FEBRUARY.MINIMUM..Centigrate.")])

```

```{r}
library(dplyr)
#dropping all other columns
df.biophysical.monthly.rainfall <- select(df.biophysical.monthly.rainfall,1:5,19:21)
df.environment.evapotranspiration.actual <- select(df.environment.evapotranspiration.actual,1:5,18:20)

df.environment.evapotranspiration.potential <- select(df.environment.evapotranspiration.potential,1:5,18:20)
df.environment.precipitation <- select(df.environment.precipitation,1:5,18:20)
df.environment.temperature.maximum <- select(df.environment.temperature.maximum,1:5,18:20)
df.environment.temperature.minimum <- select(df.environment.temperature.minimum,1:5,18:20)




```

Now that our datasets are loaded. we will try to combine all those data sets to a single DF.

We are going to use $\textbf{joins from dplyr package}$ here. We are going to use full join because we don't want to loose any data. 
we will plan to handle the missing values later.

We are getting lot of rows due to cartesian product. As per discussion with Professor,k decided to move on with join on Year and concentrate on new data first.

```{r}


combine1 <- full_join(df.rice.area.production.yield,df.rice.farm.harvest.price,by = c("Dist.Code","State.Code","State.Name","Dist.Name","Year"))
combine2 <- full_join(combine1,df.irrigation.sourcewise.irrigated.area,by = c("Dist.Code","State.Code","State.Name","Dist.Name","Year"))
combine3 <- full_join(combine2,df.irrigation.rice.area,by = c("Dist.Code","State.Code","State.Name","Dist.Name","Year"))
combine4 <- full_join(combine3,df.inputs.wages,by = c("Dist.Code","State.Code","State.Name","Dist.Name","Year"))
combine5 <- full_join(combine4,df.inputs.season.fertilizer.consumption,by = c("Dist.Code","State.Code","State.Name","Dist.Name","Year"))
combine6 <- full_join(combine5,df.inputs.fertilizer.consumption,by = c("Dist.Code","State.Code","State.Name","Dist.Name","Year"))
combine7 <- full_join(combine6,df.environment.temperature.minimum,by = c("Dist.Code","State.Code","State.Name","Dist.Name","Year"))
combine8 <- full_join(combine7,df.environment.temperature.maximum,by = c("Dist.Code","State.Code","State.Name","Dist.Name","Year"))
combine9 <- full_join(combine8,df.environment.precipitation,by = c("Dist.Code","State.Code","State.Name","Dist.Name","Year"))
combine10 <- full_join(combine9,df.environment.evapotranspiration.potential,by = c("Dist.Code","State.Code","State.Name","Dist.Name","Year"))
combine11 <- full_join(combine10,df.environment.evapotranspiration.actual,by = c("Dist.Code","State.Code","State.Name","Dist.Name","Year"))
combine12 <- full_join(combine11,df.biophysical.monthly.rainfall,by = c("Dist.Code","State.Code","State.Name","Dist.Name","Year"))
combine13 <- full_join(combine12,df.biophysical.landuse,by = c("Dist.Code","State.Code","State.Name","Dist.Name","Year"))
combine14 <- full_join(combine13,df.biophysical.length.of.growing.period,by = c("Dist.Code","State.Code","State.Name","Dist.Name"))
df.all <- full_join(combine14,df.biophysical.soil.type1,by = c("Dist.Code","State.Code","State.Name","Dist.Name"))

```
Our final dataframe consists of 884 observations with 137 predictors.
By taking averages, we reduced predictors from 137 to 82.

```{r}
#factorising
df.all$Dist.Code <- as.factor(df.all$Dist.Code)
df.all$Year.x <- as.factor(df.all$Year.x)
df.all$State.Code <- as.factor(df.all$State.Code)
df.all$State.Name <- as.factor(df.all$State.Name)
df.all$Dist.Name <- as.factor(df.all$Dist.Name)
df.all$Year <- as.factor(df.all$Year)
df.all$Year.y <- as.factor(df.all$Year.y)

```

summary

```{r}
str(df.all)

summary(df.all)
```

#TODO
#Feature engineering / reduction of predictors